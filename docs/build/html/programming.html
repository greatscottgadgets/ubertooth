

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Programming &mdash; Ubertooth  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Ubertooth
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Ubertooth</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="assembling_hardware.html">Assembling Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="bluetooth_captures_PCAP.html">Bluetooth Captures in PCAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_guide.html">Build Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_from_git.html">Building from git</a></li>
<li class="toctree-l1"><a class="reference internal" href="capturing_BLE_Wireshark.html">Capturing BLE in Wireshark</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="firmware.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_help.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usb-bootloader">USB bootloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#isp-bootloader">ISP bootloader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pogoprog">Pogoprog</a></li>
<li class="toctree-l3"><a class="reference internal" href="#an-ftdi-basic-breakout-3-3v">An FTDI Basic Breakout - 3.3V</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#method-one-the-easy-way">Method one: the easy way</a></li>
<li class="toctree-l4"><a class="reference internal" href="#method-two-the-better-way">Method two: the better way</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-isp">Using ISP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jtag">JTAG</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ubertooth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Programming</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/programming.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="programming">
<h1>Programming<a class="headerlink" href="#programming" title="Permalink to this headline">¶</a></h1>
<p>This page describes how to load compiled firmware onto an Ubertooth One. Other pages describe how to write <a class="reference external" href="https://github.com/greatscottgadgets/ubertooth/wiki/Firmware">firmware</a> or <a class="reference external" href="https://github.com/greatscottgadgets/ubertooth/wiki/Software">host code</a> for the platform.</p>
<p>There are three ways to program an Ubertooth board: the USB bootloader, the ISP bootloader, and JTAG.</p>
<div class="section" id="usb-bootloader">
<h2>USB bootloader<a class="headerlink" href="#usb-bootloader" title="Permalink to this headline">¶</a></h2>
<p>This is the recommended method of loading code onto an Ubertooth Zero or Ubertooth One provided that the USB bootloader is already installed (at the time of manufacture, for example). If you need to install the bootloader itself, you will have to use either ISP or JTAG.</p>
<p>The bootloader executes every time the device starts up from reset or power cycle. Normally it just gets out of the way and passes control to the application firmware very quickly. Alternatively it can enter Device Firmware Upgrade (DFU) mode which permits firmware upload and download over USB. There are two ways to tell the bootloader that you want it to enter DFU mode:</p>
<blockquote>
<div><ol class="arabic simple">
<li>soft bootloader entry: By setting a flag in RAM, the application firmware can instruct the bootloader to enter DFU mode following a reset (without loss of power). For example, with the bluetooth_rxtx firmware running you can trigger a reset into DFU mode using ‘ubertooth-util -f’ (located in host/bluetooth_rxtx/). Soft entry only works on Ubertooth One, not Ubertooth Zero.</li>
<li>hard bootloader entry (also known as pin entry): By connecting two pins (for Ubertooth Zero it’s pin 1 and 3) on the expansion header with a jumper during reset (either soft or hard boot), you can force the bootloader into DFU mode. When using pin entry, the bootloader will enter DFU mode for only a few seconds and will then execute the application if no DFU activity has started during that period. This allows developers to permanently or semi-permanently jumper the pins providing a DFU opportunity on every reset. This method works on Ubertooth One but not Ubertooth Zero.</li>
</ol>
</div></blockquote>
<p>The bootloader indicates DFU mode by flashing the LEDs in a distinctive pattern. It also identifies itself as “usb_bootloader” on USB.</p>
<p>During DFU mode, firmware may be uploaded or downloaded using ubertooth-dfu. See host/usb_dfu/README for usage instructions.</p>
<p>It is possible that soft bootloader entry may be broken by installing a faulty application or an application that does not provide a method of triggering soft entry. In this case, pin entry must be used (e.g. by holding a paper clip in the expansion header while plugging in the device) to “unbrick” the unit.</p>
<p>For Ubertooth One, the pins to connect are pins 1 and 3 of the expansion header (P4). For Ubertooth Zero, the pins to connect are pins 1 and 13 of the expansion header (J1).</p>
</div>
<div class="section" id="isp-bootloader">
<h2>ISP bootloader<a class="headerlink" href="#isp-bootloader" title="Permalink to this headline">¶</a></h2>
<p>The LPC175x features an In-System Programming (ISP) bootloader that allows code to be loaded over a serial interface. In order to use ISP, you will need <a class="reference external" href="http://sourceforge.net/projects/lpc21isp">lpc21isp</a> and a 3.3V serial programming device such as one of the following:</p>
<div class="section" id="pogoprog">
<h3>Pogoprog<a class="headerlink" href="#pogoprog" title="Permalink to this headline">¶</a></h3>
<p>The official Ubertooth ISP programmer is Pogoprog, an open source board that can be assembled using a process similar to Ubertooth One assembly.</p>
</div>
<div class="section" id="an-ftdi-basic-breakout-3-3v">
<h3>An FTDI Basic Breakout - 3.3V<a class="headerlink" href="#an-ftdi-basic-breakout-3-3v" title="Permalink to this headline">¶</a></h3>
<p>You can use SparkFun’s <a class="reference external" href="http://www.sparkfun.com/products/9873">FTDI Basic Breakout - 3.3V</a> to program an Ubertooth. Adafruit’s <a class="reference external" href="http://www.adafruit.com/index.php?main_page=product_info&amp;products_id=284">FTDI Friend</a> is a similar board that should work as well. To allow lpc21isp to automatically activate the LPC175x’s ISP bootloader, you must modify the board in one of two ways.</p>
<div class="section" id="method-one-the-easy-way">
<h4>Method one: the easy way<a class="headerlink" href="#method-one-the-easy-way" title="Permalink to this headline">¶</a></h4>
<p>Just short the CTS pin to GND. This will force the microcontroller into ISP mode every time it resets while the programmer is connected. In order to perform a normal reset to run the newly loaded code, you will have to first disconnect the programmer.</p>
</div>
<div class="section" id="method-two-the-better-way">
<h4>Method two: the better way<a class="headerlink" href="#method-two-the-better-way" title="Permalink to this headline">¶</a></h4>
<p>Connect the CTS pin to the RTS pin (pin 3) on the FT232RL using fine gauge wire such as wire wrap wire. This is trickier to solder, but it has the advantage that the pin will be fully controlled by lpc21isp. This means that you can leave the programmer connected to the Ubertooth board throughout multiple program/test cycles.</p>
</div>
<div class="section" id="using-isp">
<h4>Using ISP<a class="headerlink" href="#using-isp" title="Permalink to this headline">¶</a></h4>
<img alt="_images/pogoprog-placement.jpeg" src="_images/pogoprog-placement.jpeg" />
<p>Warning: Code loaded via ISP will blow away the bootloader. It is generally recommended to use this method only for installing the bootloader itself.</p>
<p>Connect your serial programmer to the Ubertooth board and type “make program” in the firmware source code directory. If you have a precompiled binary in .hex format, you can invoke lpc21isp directly with “lpc21isp -control firmware.hex /dev/ttyUSB0 230400 4000” (replacing firmware.hex with the firmware filename and /dev/ttyUSB0 with the device file of your serial programmer.</p>
</div>
</div>
<div class="section" id="jtag">
<h3>JTAG<a class="headerlink" href="#jtag" title="Permalink to this headline">¶</a></h3>
<p>Warning: Code loaded via JTAG will blow away the bootloader. It is generally recommended to use this method only for installing the bootloader itself.</p>
<p>Connect your ARM Cortex-M3 JTAG debugger (such as one supported by <a class="reference external" href="http://openocd.berlios.de/web">OpenOCD</a>) to the standard Cortex Debug Connector on the Ubertooth One or the non-standard JTAG connector on the Ubertooth Zero. You know what to do.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Great Scott Gadgets.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>