

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>One minute to understand BLE connection data package &mdash; Ubertooth  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="One minute to understand BLE advertising data package" href="BLE_advertising_data_package.html" />
    <link rel="prev" title="Ubertooth Zero" href="ubertooth_zero.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Ubertooth
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Ubertooth</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="assembling_hardware.html">Assembling Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="bluetooth_captures_PCAP.html">Bluetooth Captures in PCAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_guide.html">Build Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_from_git.html">Building from git</a></li>
<li class="toctree-l1"><a class="reference internal" href="capturing_BLE_Wireshark.html">Capturing BLE in Wireshark</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="firmware.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_help.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="programming.html">Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="Release_2015-10-R1.html">Release 2015-10-R1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Release_2017_03_R2.html">Release 2017-03-R2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Release_2018-08-R1.html">Release 2018-08-R1: the DEFCON release</a></li>
<li class="toctree-l1"><a class="reference internal" href="Release_2018-12-R1.html">Release 2018-12-R1</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_procedure.html">Release Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="software.html">Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="third_party_software.html">Third Party Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="to_do.html">ToDo List</a></li>
<li class="toctree-l1"><a class="reference internal" href="ubertooth_one.html">Ubertooth One</a></li>
<li class="toctree-l1"><a class="reference internal" href="ubertooth_two_wishlist.html">Ubertooth Two Wishlist</a></li>
<li class="toctree-l1"><a class="reference internal" href="ubertooth_zero.html">Ubertooth Zero</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">One minute to understand BLE connection data package</a></li>
<li class="toctree-l1"><a class="reference internal" href="BLE_advertising_data_package.html">One minute to understand BLE advertising data package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ubertooth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>One minute to understand BLE connection data package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/BLE_connection_package.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="one-minute-to-understand-ble-connection-data-package">
<h1>One minute to understand BLE connection data package<a class="headerlink" href="#one-minute-to-understand-ble-connection-data-package" title="Permalink to this headline">¶</a></h1>
<ol class="arabic">
<li><p class="first">Profile During connection procedure of BLE, there are three packages: SCAN_REQ, SCAN_RSP and CONNECT_REQ.</p>
<blockquote>
<div><p><strong>SCAN_REQ:</strong> Scan request, issued by MASTER DEVICE, send to SLAVE DEVICE，sent by the Link Layer in the Scanning State, received by a Link Layer in the Advertising State.</p>
<p><strong>SCAN_RSP:</strong> Sent by the Link Layer in the Advertising State, received by a Link Layer in the Scanning State, it’s Sanother function is as a complement of advertising data, slave device could transfer more advertising data to master device, for example, device name could be inside this package instead of advertising package.</p>
<p><strong>CONNECT_REQ:</strong> Issued by master device. This PDU is sent by the Link Layer in the Initiating State and received by the Link Layer in the Advertising State. Once slave device received this PDU, the connection will be set immediately and enter connection state (master device and slave device will exchange effective PDU or empty PDU.</p>
<p>Detail description see below.</p>
</div></blockquote>
</li>
<li><p class="first">Keywords：Hollong BLE Sniffer，BLE analyzer，BLE data acquiring, BLE Data Analyzer，BLE Capture</p>
</li>
<li><p class="first">Preparation before capturing BLE data</p>
<blockquote>
<div><ul class="simple">
<li>Hardware: One BLE device (as slave device) and one master device(such as lightblue or redwoods app in iOS or Android)； One HOLLONG BLE SNIFFER.</li>
<li>Software: Hollong BLE sniffer and protocol analyzer.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">SCAN_REQ PDU</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Complete data</p>
</li>
<li><p class="first">Access Address:  for advertising PDU, it is fixed length (4 bytes) and fixed contents（0x8e89bed6) which master and slave device could be addressed.</p>
</li>
<li><p class="first">Header Info: fxied (2 bytes)：used as 16 bites</p>
<blockquote>
<div><ul>
<li><p class="first">BIT[0:3]：advertising PDU type：</p>
<blockquote>
<div><ul class="simple">
<li>PDU Type</li>
<li>b3b2b1b0 Packet Name</li>
<li>0000 ADV_IND： connectable undirected advertising event</li>
<li>0001 ADV_DIRECT_IND：connectable directed advertising event</li>
<li>0010 ADV_NONCONN_IND：non-connectable undirected advertising event</li>
<li>0011 SCAN_REQ：scan request</li>
<li>0100 SCAN_RSP: scan response</li>
<li>0101 CONNECT_REQ：connection request</li>
<li>0110 ADV_SCAN_IND：scannable undirected advertising event</li>
<li>0111-1111 Reserved</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">BIT[4:5]：Reserved</p>
</li>
<li><p class="first">BIT[6]：RxAdd</p>
</li>
<li><p class="first">BIT[7]：TxAdd</p>
</li>
<li><p class="first">BIT[8:13]：advertising data length （Maximum 37 bytes)</p>
</li>
<li><p class="first">BIT[14:15]：Reserved</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Master device address</p>
</li>
<li><p class="first">Slave device address</p>
</li>
<li><p class="first">CRC</p>
</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">SCAN_RSP PDU</p>
</li>
</ol>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="BLE_advertising_data_package.html" class="btn btn-neutral float-right" title="One minute to understand BLE advertising data package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ubertooth_zero.html" class="btn btn-neutral float-left" title="Ubertooth Zero" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Great Scott Gadgets.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>